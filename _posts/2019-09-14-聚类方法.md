---
layout: post
title: 聚类方法的原理与实现
date: 2019-09-14
tags: Machine_Learning
---

# 聚类的基本概念

聚类是针对给定的样本，依据它们特征的相似度或距离，将其归并为若干个“类”或“族”的数据分析问题。聚类的方法有很多，本博客介绍最常用的两种聚类算法：层次聚类(hierarchical clustering)和k均值聚类(k-means clustering)。

## 相似度或距离

聚类需要根据样本特征的相似度或者距离来作为是否归属于某一类的依据，也就是相似的样本归为一类，不相似的样本不归为一类。度量样本特征的相似度或者距离有多种方式，具体哪种相似度更适合取决于应用问题的特性。


![img](/images/posts/matlab/26.png)

准确的来说闵科夫斯基距离是一组距离的定义，随着次数的增加，向量分量中的大值对距离的贡献会越大，极端下切比雪夫距离只考虑最大的那个分量。一般常用欧式距离。闵科夫斯基距离的缺点一是对所有分量一视同仁，没有考虑不同特征之间的区别，二是没有考虑分量的量纲的影响，相同的特征，变换一下量纲级别就会导致完全不一样的结果，三是没有考虑各个分量之间的分布（期望，方差）。

![img](/images/posts/matlab/27.png)

给定一个样本集合$X$,$X=(x_{ij})_{n*m}$,其协方差矩阵记作S。样本$x_{i}$与样本$x_{j}$之间的马哈拉诺比斯距离(Mahalalanobis distance)。

其中，$x_{i}=(x_{1i},x_{2i},...,x_{mi})^{T},x_{j}=(x_{1j},x_{2j},...,x_{mj})^{T}$。S是整体样本的协方差矩阵， 当协方差矩阵为单位矩阵的时候，马氏距离就等于欧式距离，当协方差矩阵仅为对角矩阵的时候，即为标准化之后的欧式距离，由此可以看出马氏距离的两个优点，一是排除了量纲的影响，相当于标准化了，二是排除了变量之间的相关性的影响，相当除掉掉了向量线性相关部分。马氏距离的缺点是夸大了变化微小变量的作用。

![img](/images/posts/matlab/28.png)

相关系数是针对不同含义的特征之间，衡量彼此的线性关系是否密切，如果密切则考虑合并两个特征，或者对于不同样本之间，相互之间的特征线性关系如果密切，则说明属于同一类别，但这需要特征维度足够大才能说明问题，因为相关系数的一个明显的缺点就是其接近1的程度与公式中m值相关，m值比较小时，相关系数波动大，有些样本相关系数容易接近于1，m值较大时，相关系数的绝对值容易偏小，对于不同的m值之间的样本不具备可比性，比如不能通过对比不同维度的向量对的相关系数的大小，就能判断某一对比另一对更线性相关。


![img](/images/posts/matlab/29.png)

用两个向量夹角的余弦值来衡量两者的相似性，余弦值为1，则角度为零度，说明两个向量完全指向相同的方向，余弦值为0，角度为90度，说明两者之间是独立的，余弦值为-1则说明两者指向相反的方向。余弦相似度常用于高维正空间，比计算文本相似度。

## 类或簇

![img](/images/posts/matlab/30.png)

类间距离：1、最短距离：两个类的样本之间的最短距离；2、最长距离：类似定义；3、中心距离：类心与类心之间的距离；4、平均距离：任意两个不同类的样本之间距离的均值。


# 层次聚类
层次聚类方法对给定的数据集进行层次的分解，直到某种条件满足为止。

在已经得到距离值之后，元素间可以被联系起来。通过分离和融合可以构建一个结构。传统上，表示的方法是树形数据结构，层次聚类算法，要么是自底向上聚集型的，即从叶子节点开始，最终汇聚到根节点；要么是自顶向下分裂型的，即从根节点开始，递归的向下分裂。
![img](/images/posts/matlab/31.png)

* 凝聚层次聚类：AGNES算法(自底向上)：首先将每个对象作为一个簇，然后合并这些原子簇为越来越大的簇，直到某个终结条件被满足

* 分裂层次聚类：DIANA算法(自顶向下)：首先将所有对象置于一个簇中，然后逐渐细分为越来越小的簇，直到达到了某个终结条件。


```matlab
%Q型聚类分析
clc,clear;
a=[1,0;1,1;3,2;4,3;2,5;]; %处理数据矩阵，可变化，拿以上数据举例 
a=zscore(a);              %数据标准化处理
y=pdist(a,'cityblock');   %求a的行向量之间的绝对距离,关于pdist函数下面有介绍，P222
%‘euclidean’：欧氏距离（默认）；‘seuclidean’：标准化欧氏距离；
%‘mahalanobis’：马氏距离；‘cityblock’：布洛克距离；
%‘minkowski’：明可夫斯基距离；‘chebychev’：Chebychev距离。

yc=squareform(y);         %变换成距离方阵
z=linkage(y);             %产生等级聚类图
[h,t]=dendrogram(z);      %画聚类图
T=cluster(z,'maxclust',3);%把对象分成3份，参数可自行修改成2,4,5等，记得将下一行i值修改
for i=1:3;
    tm=find(T==i);        %求第i类的对象
    tm=reshape(tm,1,length(tm));%变成行向量
    fprintf('第%d类的有%s\n',i,int2str(tm));%显示分类结果
end
```



```matlab

```



